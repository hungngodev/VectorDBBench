#!/usr/bin/env bash

NS=${NS:-marco}
IMG=${IMG:-hungngodev/vectordbbench:latest}

DATA_DIR=${DATA_DIR:-/opt/vdb/datasets}
HOST_DATA_DIR=${HOST_DATA_DIR:-/mnt/nfs/home/hmngo/work1/hmngo/datasets}
HOST_RESULTS_DIR=${HOST_RESULTS_DIR:-/mnt/nfs/home/hmngo/work1/hmngo/vdb_results}
RESULT_ROOT=${RESULT_ROOT:-/mnt/nfs/home/hmngo/work1/hmngo/vdb_results}

CASE_TYPE=${CASE_TYPE:-Performance768D100K}
NUM_CONCURRENCY=${NUM_CONCURRENCY:-"1,2,4,8,16,32,64,128,256,512,1024"}
CONCURRENCY_DURATION=${CONCURRENCY_DURATION:-30}
EF_CONSTRUCTION=${EF_CONSTRUCTION:-256}
REPLICA=${REPLICA:-3}
SHARDING=${SHARDING:-1}
K=${K:-100}

HNSW_M_VALUES=${HNSW_M_VALUES:-"32"}
HNSW_EF_VALUES=${HNSW_EF_VALUES:-"100 110 120 130 140 150 160 170 180 190 200 210 220 230 240 250 260 270 280 290 300 325 350 375 400 450 500 600 700 800 1000 1200"}

CPU=${CPU:-16}
MEM=${MEM:-160Gi}
PROTOBUF_VERSION=${PROTOBUF_VERSION:-6.31.1}

ENABLE_MILVUS=${ENABLE_MILVUS:-true}
ENABLE_WEAVIATE=${ENABLE_WEAVIATE:-true}
ENABLE_QDRANT=${ENABLE_QDRANT:-false}
ENABLE_VALD=${ENABLE_VALD:-false}

DROP_OLD_QDRANT=${DROP_OLD_QDRANT:-true}
VALD_WAIT_SECONDS=${VALD_WAIT_SECONDS:-60}
VALD_TIMEOUT=${VALD_TIMEOUT:-300}
VALD_CONCURRENCIES=${VALD_CONCURRENCIES:-"1"}

TIMESTAMP=$(date +%Y%m%d-%H%M)
# BATCH_ID: Case type, EF construction, K, timestamp (M/EF/Rep/Shard are in individual task labels)
BATCH_ID=${BATCH_ID:-"${CASE_TYPE}_EFC${EF_CONSTRUCTION}_K${K}_${TIMESTAMP}"}

export NS IMG DATA_DIR HOST_DATA_DIR HOST_RESULTS_DIR RESULT_ROOT
export CASE_TYPE NUM_CONCURRENCY CONCURRENCY_DURATION EF_CONSTRUCTION REPLICA SHARDING K
export HNSW_M_VALUES HNSW_EF_VALUES CPU MEM PROTOBUF_VERSION
export ENABLE_MILVUS ENABLE_WEAVIATE ENABLE_QDRANT ENABLE_VALD
export DROP_OLD_QDRANT VALD_WAIT_SECONDS VALD_TIMEOUT VALD_CONCURRENCIES
export BATCH_ID
